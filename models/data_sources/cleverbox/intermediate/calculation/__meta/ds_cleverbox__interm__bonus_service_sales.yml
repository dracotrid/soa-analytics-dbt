version: 2

models:
  - name: ds_cleverbox__interm__bonus_service_sales
    description: "CleverBox Intermediate Bonus Service Sales"
    config:
      alias: interm__bonus_service_sales
      meta:
        tf_config:
          filter: eid IS NOT NULL
    columns:
      - name: eid
        data_type: STRING
        description: Record identifier
      - name: date
        data_type: DATE
        description: Service date of sale
      - name: year
        data_type: STRING
        description: Service year of sale
        meta:
          tf_config:
            expression: EXTRACT(YEAR FROM date)
      - name: expert_name
        data_type: STRING
        description: The employee who sold the service
      - name: expert_position
        data_type: STRING
        description: Speciality of employee
      - name: service_name
        data_type: STRING
        description: Service name
      - name: category
        data_type: STRING
        description: Service category
      - name: client_name
        data_type: STRING
        description: Client name
      - name: amount
        data_type: NUMERIC.AMOUNT
        description: Amount of services sold
      - name: paid
        data_type: NUMERIC.COST
        description: Sum which client paid
      - name: cost_total
        data_type: NUMERIC.COST
        description: Cost of services
      - name: cost_price_total
        data_type: NUMERIC.PRICE
        description: Service cost price
      - name: subscription
        data_type: NUMERIC.COST
        description: Subscription
      - name: bonus_employee__code
        data_type: STRING
        description: Bonus code from bonus_employee table
      - name: bonus_employee__type
        data_type: STRING
        description: Bonus type from bonus_employee table
      - name: bonus_employee__value
        data_type: NUMERIC.COST
        description: Bonus value from bonus_employee table
      - name: is_first_visit
        data_type: BOOLEAN
        description: Is first visit
      - name: bonus_employee__min_bonus_first_visit
        data_type: NUMERIC.COST
        description: Bonus value for first visit if paid less min expected sum from bonus_employee table
      - name: bonus_employee__expected_sum_first_visit
        data_type: NUMERIC.COST
        description: Min expected sum for first visit from bonus_employee table
      - name: visit_sum
        data_type: NUMERIC.COST
        description: Sum which client spent
      - name: bonus_discount_name
        data_type: STRING
        description: Bonus name from bonus_discount table
      - name: bonus_discount_type
        data_type: STRING
        description: Bonus type from bonus_discount table
      - name: bonus_discount_value
        data_type: NUMERIC.COST
        description: Bonus value from bonus_discount table
      - name: discount_usage_discount_name
        data_type: STRING
        description: Discount name from discount_usage table
      - name: is_vip
        data_type: BOOLEAN
        description: Client is VIP
      - name: is_employee
        data_type: BOOLEAN
        description: Client is employee
      - name: is_first_visit
        data_type: BOOLEAN
        description: Is first clients visit
      - name: discount_rate
        data_type: NUMERIC.PRICE
        description: Discount rate
      - name: discount_name_source
        data_type: STRING
        description: ""
      - name: is_bonus_without_cost_price
        data_type: BOOLEAN
        description: Is bonus calculate without cost price
      - name: bonus_type_for_calculation
        data_type: STRING
        description: Bonus type for calculation employee bonus
      - name: bonus_value
        data_type: NUMERIC.COST
        description: Bonus value
      - name: cost_for_bonus
        data_type: NUMERIC.COST
        description: Cost for bonus calculation
      - name: base_for_bonus
        data_type: NUMERIC.COST
        description: Base for bonus calculation
      - name: bonus_calculated
        data_type: NUMERIC.COST
        description: Calculated total employee bonus for selling service. Can be negative
      - name: bonus_total
        data_type: NUMERIC.COST
        description: Total employee bonus for selling service
